const { DynamoDBClient } = require('@aws-sdk/client-dynamodb');
const { DynamoDBDocumentClient, PutCommand } = require('@aws-sdk/lib-dynamodb');

const client = new DynamoDBClient({ region: 'ap-northeast-2' });
const docClient = DynamoDBDocumentClient.from(client);

const PAYMENTS_TABLE = 'mcp-poc-payments';
const USER_ID = 'e4580d7c-4021-70fe-a0c1-e66ee2b65b40'; // juhyeong의 Cognito sub

const payments = [
  { "일자": "2025-07-21", "가맹점명": "푸디스트여의도점", "금액": 6500, "적립": 65, "일시불할부": "일시불" },
  { "일자": "2025-07-21", "가맹점명": "덕자네방앗간", "금액": 7000, "적립": 70, "일시불할부": "일시불" },
  { "일자": "2025-07-20", "가맹점명": "택시-서울 31 자 7692", "금액": 7100, "적립": 71, "일시불할부": "일시불" },
  { "일자": "2025-07-18", "가맹점명": "cut", "금액": 23000, "적립": 230, "일시불할부": "일시불" },
  { "일자": "2025-07-18", "가맹점명": "풀바셋여의도점", "금액": 5520, "적립": 55, "일시불할부": "일시불" },
  { "일자": "2025-07-18", "가맹점명": "장터", "금액": 10000, "적립": 100, "일시불할부": "일시불" },
  { "일자": "2025-07-17", "가맹점명": "이마트24여의도점", "금액": 720, "적립": 7, "일시불할부": "일시불" },
  { "일자": "2025-07-17", "가맹점명": "이마트24여의도점", "금액": 1000, "적립": 10, "일시불할부": "일시불" },
  { "일자": "2025-07-17", "가맹점명": "이마트24여의도점", "금액": 540, "적립": 5, "일시불할부": "일시불" },
  { "일자": "2025-07-22", "가맹점명": "덕자네방앗간", "금액": 8500, "적립": 85, "일시불할부": "일시불" },
  { "일자": "2025-07-22", "가맹점명": "택시-서울 33 바 1650", "금액": 16500, "적립": 165, "일시불할부": "일시불" },
  { "일자": "2025-07-22", "가맹점명": "택시-서울 32 자 3006", "금액": 5200, "적립": 52, "일시불할부": "일시불" },
  { "일자": "2025-07-23", "가맹점명": "이마트24여의도점", "금액": 5640, "적립": 56, "일시불할부": "일시불" },
  { "일자": "2025-07-23", "가맹점명": "커피나인KBS", "금액": 11800, "적립": 118, "일시불할부": "일시불" },
  { "일자": "2025-07-23", "가맹점명": "계몽", "금액": 29000, "적립": 290, "일시불할부": "일시불" },
  { "일자": "2025-07-23", "가맹점명": "계몽", "금액": 4500, "적립": 45, "일시불할부": "일시불" },
  { "일자": "2025-07-24", "가맹점명": "Google One,USD:19.99", "금액": 27975, "적립": 279, "일시불할부": "일시불" },
  { "일자": "2025-07-24", "가맹점명": "GS25 여의도점", "금액": 4100, "적립": 41, "일시불할부": "일시불" },
  { "일자": "2025-07-25", "가맹점명": "푸디스트여의도점", "금액": 6700, "적립": 67, "일시불할부": "일시불" },
  { "일자": "2025-07-26", "가맹점명": "이마트24여의도점", "금액": 2800, "적립": 28, "일시불할부": "일시불" },
  { "일자": "2025-07-26", "가맹점명": "스타벅스 여의도점", "금액": 6100, "적립": 61, "일시불할부": "일시불" },
  { "일자": "2025-07-27", "가맹점명": "버거킹 여의도점", "금액": 8900, "적립": 89, "일시불할부": "일시불" },
  { "일자": "2025-07-27", "가맹점명": "이마트24여의도점", "금액": 3600, "적립": 36, "일시불할부": "일시불" },
  { "일자": "2025-07-28", "가맹점명": "풀바셋여의도점", "금액": 6200, "적립": 62, "일시불할부": "일시불" },
  { "일자": "2025-07-28", "가맹점명": "덕자네방앗간", "금액": 7500, "적립": 75, "일시불할부": "일시불" },
  { "일자": "2025-07-29", "가맹점명": "스타벅스 여의도점", "금액": 5700, "적립": 57, "일시불할부": "일시불" },
  { "일자": "2025-07-29", "가맹점명": "택시-서울 33 아 2145", "금액": 9100, "적립": 91, "일시불할부": "일시불" },
  { "일자": "2025-07-30", "가맹점명": "이마트24여의도점", "금액": 2100, "적립": 21, "일시불할부": "일시불" },
  { "일자": "2025-07-30", "가맹점명": "GS25 여의도점", "금액": 3500, "적립": 35, "일시불할부": "일시불" },
  { "일자": "2025-07-31", "가맹점명": "풀바셋여의도점", "금액": 6800, "적립": 68, "일시불할부": "일시불" },
  { "일자": "2025-07-31", "가맹점명": "푸디스트여의도점", "금액": 6400, "적립": 64, "일시불할부": "일시불" },
  { "일자": "2025-08-01", "가맹점명": "스타벅스 여의도점", "금액": 5200, "적립": 52, "일시불할부": "일시불" },
  { "일자": "2025-08-01", "가맹점명": "CU 편의점", "금액": 3000, "적립": 30, "일시불할부": "일시불" },
  { "일자": "2025-08-02", "가맹점명": "이마트24여의도점", "금액": 4200, "적립": 42, "일시불할부": "일시불" },
  { "일자": "2025-08-02", "가맹점명": "버거킹 여의도점", "금액": 8700, "적립": 87, "일시불할부": "일시불" },
  { "일자": "2025-08-03", "가맹점명": "택시-서울 32 마 4123", "금액": 13200, "적립": 132, "일시불할부": "일시불" },
  { "일자": "2025-08-03", "가맹점명": "스타벅스 여의도점", "금액": 5600, "적립": 56, "일시불할부": "일시불" },
  { "일자": "2025-08-04", "가맹점명": "푸디스트여의도점", "금액": 7200, "적립": 72, "일시불할부": "일시불" },
  { "일자": "2025-08-04", "가맹점명": "풀바셋여의도점", "금액": 6100, "적립": 61, "일시불할부": "일시불" },
  { "일자": "2025-08-05", "가맹점명": "GS25 여의도점", "금액": 2800, "적립": 28, "일시불할부": "일시불" },
  { "일자": "2025-08-05", "가맹점명": "덕자네방앗간", "금액": 7900, "적립": 79, "일시불할부": "일시불" },
  { "일자": "2025-08-06", "가맹점명": "이마트24여의도점", "금액": 3300, "적립": 33, "일시불할부": "일시불" },
  { "일자": "2025-08-06", "가맹점명": "스타벅스 여의도점", "금액": 5900, "적립": 59, "일시불할부": "일시불" },
  { "일자": "2025-08-07", "가맹점명": "풀바셋여의도점", "금액": 6400, "적립": 64, "일시불할부": "일시불" },
  { "일자": "2025-08-07", "가맹점명": "푸디스트여의도점", "금액": 6800, "적립": 68, "일시불할부": "일시불" },
  { "일자": "2025-08-08", "가맹점명": "택시-서울 31 허 2845", "금액": 11200, "적립": 112, "일시불할부": "일시불" },
  { "일자": "2025-08-08", "가맹점명": "GS25 여의도점", "금액": 3100, "적립": 31, "일시불할부": "일시불" },
  { "일자": "2025-08-09", "가맹점명": "스타벅스 여의도점", "금액": 5400, "적립": 54, "일시불할부": "일시불" },
  { "일자": "2025-08-09", "가맹점명": "덕자네방앗간", "금액": 7200, "적립": 72, "일시불할부": "일시불" },
  { "일자": "2025-08-10", "가맹점명": "풀바셋여의도점", "금액": 6500, "적립": 65, "일시불할부": "일시불" },
  { "일자": "2025-08-11", "가맹점명": "푸디스트여의도점", "금액": 7100, "적립": 71, "일시불할부": "일시불" },
  { "일자": "2025-08-11", "가맹점명": "스타벅스 여의도점", "금액": 5600, "적립": 56, "일시불할부": "일시불" },
  { "일자": "2025-08-12", "가맹점명": "이마트24여의도점", "금액": 2500, "적립": 25, "일시불할부": "일시불" },
  { "일자": "2025-08-12", "가맹점명": "풀바셋여의도점", "금액": 6300, "적립": 63, "일시불할부": "일시불" },
  { "일자": "2025-08-13", "가맹점명": "덕자네방앗간", "금액": 8400, "적립": 84, "일시불할부": "일시불" },
  { "일자": "2025-08-13", "가맹점명": "GS25 여의도점", "금액": 3700, "적립": 37, "일시불할부": "일시불" },
  { "일자": "2025-08-14", "가맹점명": "푸디스트여의도점", "금액": 6900, "적립": 69, "일시불할부": "일시불" },
  { "일자": "2025-08-14", "가맹점명": "스타벅스 여의도점", "금액": 5700, "적립": 57, "일시불할부": "일시불" },
  { "일자": "2025-08-15", "가맹점명": "풀바셋여의도점", "금액": 6000, "적립": 60, "일시불할부": "일시불" },
  { "일자": "2025-08-16", "가맹점명": "GS25 여의도점", "금액": 3400, "적립": 34, "일시불할부": "일시불" },
  { "일자": "2025-08-16", "가맹점명": "스타벅스 여의도점", "금액": 5900, "적립": 59, "일시불할부": "일시불" },
  { "일자": "2025-08-17", "가맹점명": "푸디스트여의도점", "금액": 7000, "적립": 70, "일시불할부": "일시불" },
  { "일자": "2025-08-18", "가맹점명": "풀바셋여의도점", "금액": 6200, "적립": 62, "일시불할부": "일시불" },
  { "일자": "2025-08-18", "가맹점명": "덕자네방앗간", "금액": 7800, "적립": 78, "일시불할부": "일시불" },
  { "일자": "2025-08-19", "가맹점명": "택시-서울 33 우 3891", "금액": 12300, "적립": 123, "일시불할부": "일시불" },
  { "일자": "2025-08-20", "가맹점명": "이마트24여의도점", "금액": 2700, "적립": 27, "일시불할부": "일시불" }
];

async function seedPayments() {
  console.log('💳 실제 결제내역 데이터 시드 시작...\n');
  console.log(`사용자 ID: ${USER_ID}`);
  console.log(`총 ${payments.length}개 항목 처리 중...\n`);

  let successCount = 0;
  let errorCount = 0;

  for (let i = 0; i < payments.length; i++) {
    const payment = payments[i];
    const paymentId = `pay-${payment.일자}-${i + 1}`;
    
    try {
      await docClient.send(
        new PutCommand({
          TableName: PAYMENTS_TABLE,
          Item: {
            userId: USER_ID,
            paymentId: paymentId,
            amount: payment.금액,
            currency: 'KRW',
            paidAt: `${payment.일자}T09:00:00Z`,
            merchant: payment.가맹점명,
            points: payment.적립,
            installment: payment.일시불할부,
          },
        })
      );
      
      successCount++;
      if (successCount % 10 === 0) {
        console.log(`진행 중... ${successCount}/${payments.length}`);
      }
    } catch (error) {
      console.error(`❌ ${paymentId} 추가 실패:`, error.message);
      errorCount++;
    }
  }

  console.log('\n🎉 데이터 시드 완료!');
  console.log(`✅ 성공: ${successCount}개`);
  if (errorCount > 0) {
    console.log(`❌ 실패: ${errorCount}개`);
  }
  console.log(`\n📊 총 결제 금액: ${payments.reduce((sum, p) => sum + p.금액, 0).toLocaleString()}원`);
  console.log(`🎁 총 적립 포인트: ${payments.reduce((sum, p) => sum + p.적립, 0).toLocaleString()}점`);
}

seedPayments().catch(console.error);


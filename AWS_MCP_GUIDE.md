# ğŸš€ AWS MCP ì„œë²„ - Claude ì—°ê²° ê°€ì´ë“œ (ë£¨ë‚˜ì¹´ë“œ)

## âœ… ë°°í¬ ì™„ë£Œ!

MCP ì„œë²„ê°€ AWS Lambda + API Gatewayì— ì„±ê³µì ìœ¼ë¡œ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤!

---

## ğŸ“‹ MCP ì„œë²„ ì •ë³´

**MCP Server URL:**
```
https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com
```

**ì—”ë“œí¬ì¸íŠ¸:**
- `GET /health` - í—¬ìŠ¤ì²´í¬
- `GET /mcp/info` - MCP ì„œë²„ ì •ë³´
- `GET /mcp/tools` - ì‚¬ìš© ê°€ëŠ¥í•œ íˆ´ ëª©ë¡
- `POST /mcp` - MCP í”„ë¡œí† ì½œ ë©”ì‹œì§€ ì²˜ë¦¬ (JSON-RPC 2.0)

---

## ğŸ”— Claudeì— ì—°ê²°í•˜ê¸°

### 1ë‹¨ê³„: Claude ì„¤ì • ì—´ê¸°

#### Pro/Max ì‚¬ìš©ì:
1. https://claude.ai ì ‘ì†
2. **Settings (âš™ï¸)** â†’ **Connectors**

#### Team/Enterprise ì‚¬ìš©ì:
1. **Admin settings** â†’ **Connectors**

### 2ë‹¨ê³„: ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ì¶”ê°€

1. **"Add custom connector"** í´ë¦­
2. **Server URL ì…ë ¥**:
   ```
   https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com
   ```
3. **"Add"** í´ë¦­

### 3ë‹¨ê³„: ì»¤ë„¥í„° í™œì„±í™”

1. ìƒˆ ì±„íŒ… ì‹œì‘
2. ì¢Œì¸¡ í•˜ë‹¨ **"Search and tools"** ë²„íŠ¼ (ğŸ”) í´ë¦­
3. **"Luna Card MCP Server"** í† ê¸€ì„ **ON**ìœ¼ë¡œ ë³€ê²½

### 4ë‹¨ê³„: í…ŒìŠ¤íŠ¸!

ì±„íŒ…ì°½ì— ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•´ë³´ì„¸ìš”:

```
ë£¨ë‚˜ì¹´ë“œ ìƒí’ˆì„ ì•Œë ¤ì¤˜
```

ë˜ëŠ”

```
ê¸ˆìœµ ìƒí’ˆ ëª©ë¡ì„ ë³´ì—¬ì¤˜
```

âœ… Claudeê°€ ìë™ìœ¼ë¡œ `getPublicContent` íˆ´ì„ í˜¸ì¶œí•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´ ì„±ê³µ!

---

## ğŸ”’ OAuth ì¸ì¦ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (ê²°ì œ ë‚´ì—­ ì¡°íšŒ)

### í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€:
```
ë‚´ ê²°ì œ ë‚´ì—­ì„ ì¡°íšŒí•´ì¤˜
```

Claudeê°€ ë‹¤ìŒê³¼ ê°™ì´ ì‘ë‹µí•©ë‹ˆë‹¤:
- OAuth ë¡œê·¸ì¸ì´ í•„ìš”í•˜ë‹¤ê³  ì•ˆë‚´
- "Connect" ë²„íŠ¼ í‘œì‹œ

**ì°¸ê³ :** í˜„ì¬ OAuth íë¦„ì€ Lambda í™˜ê²½ì—ì„œ ì œí•œì ì…ë‹ˆë‹¤. 
ê²°ì œ ë‚´ì—­ ì¡°íšŒë¥¼ ìœ„í•´ì„œëŠ”:
1. Cognitoì—ì„œ í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±
2. JWT í† í°ì„ ì§ì ‘ ë°œê¸‰ë°›ì•„ Authorization í—¤ë”ë¡œ ì „ë‹¬

---

## ğŸ§ª ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (cURL)

### 1. í—¬ìŠ¤ì²´í¬
```bash
curl https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com/health
```

### 2. MCP ì„œë²„ ì •ë³´
```bash
curl https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com/mcp/info
```

### 3. ê³µê°œ ì»¨í…ì¸  ì¡°íšŒ (ì¹´ë“œ ìƒí’ˆ)
```bash
curl -X POST https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/call",
    "params": {
      "name": "getPublicContent",
      "arguments": {
        "type": "cards"
      }
    }
  }'
```

### 4. ê³µê°œ ì»¨í…ì¸  ì¡°íšŒ (ê¸ˆìœµ ìƒí’ˆ)
```bash
curl -X POST https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/call",
    "params": {
      "name": "getPublicContent",
      "arguments": {
        "type": "products"
      }
    }
  }'
```

---

## ğŸ“Š ì‚¬ìš© ê°€ëŠ¥í•œ íˆ´

### 1. getPublicContent
**ì„¤ëª…:** ê³µê°œ ì»¨í…ì¸ (ì¹´ë“œ ë˜ëŠ” ìƒí’ˆ ì •ë³´)ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.  
**ì¸ì¦:** ë¶ˆí•„ìš”  
**íŒŒë¼ë¯¸í„°:**
- `type`: `"cards"` ë˜ëŠ” `"products"`

**ì˜ˆì‹œ ì‘ë‹µ:**
```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "[{\"contentId\": \"card-001\", \"title\": \"ë£¨ë‚˜ì¹´ë“œ ìŠ¤íƒ€\", ...}]"
      }
    ]
  }
}
```

### 2. getPayments
**ì„¤ëª…:** ì‚¬ìš©ìì˜ ê²°ì œ ë‚´ì—­ì„ ì¡°íšŒí•©ë‹ˆë‹¤.  
**ì¸ì¦:** í•„ìš” (OAuth JWT í† í°)  
**íŒŒë¼ë¯¸í„°:** ì—†ìŒ

**ì˜ˆì‹œ ìš”ì²­ (Authorization í—¤ë” í¬í•¨):**
```bash
curl -X POST https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com/mcp \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/call",
    "params": {
      "name": "getPayments",
      "arguments": {}
    }
  }'
```

---

## ğŸ›  ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude.ai (ì›¹ë¸Œë¼ìš°ì €)                           â”‚
â”‚  "ë£¨ë‚˜ì¹´ë“œ ìƒí’ˆ ì •ë³´ ì•Œë ¤ì¤˜"                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ HTTPS ìš”ì²­
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway (AWS)                               â”‚
â”‚  https://3b044wjwkf...amazonaws.com             â”‚
â”‚  - CORS ì„¤ì •                                     â”‚
â”‚  - ë¼ìš°íŒ…                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Lambda Function: mcp-poc-mcp-server            â”‚
â”‚  - MCP í”„ë¡œí† ì½œ ì²˜ë¦¬ (JSON-RPC 2.0)              â”‚
â”‚  - íˆ´ ì‹¤í–‰                                       â”‚
â”‚  - JWT ì¸ì¦ (ì„ íƒì )                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DynamoDB Tables                                 â”‚
â”‚  - mcp-poc-contents (ê³µê°œ ì»¨í…ì¸ )                â”‚
â”‚  - mcp-poc-payments (ê²°ì œ ë‚´ì—­)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ ì¥ì 

### âœ… ngrok ë¶ˆí•„ìš”
- ë¡œì»¬ ì„œë²„ ì‹¤í–‰ í•„ìš” ì—†ìŒ
- í„°ë„ë§ ì„œë¹„ìŠ¤ ë¶ˆí•„ìš”
- í•­ìƒ ì ‘ê·¼ ê°€ëŠ¥í•œ ê³ ì • URL

### âœ… AWS í†µí•©
- ê¸°ì¡´ ì¸í”„ë¼ì™€ í†µí•©
- Cognito, DynamoDB ì§ì ‘ ì‚¬ìš©
- CloudWatchë¡œ ë¡œê·¸ í™•ì¸ ê°€ëŠ¥

### âœ… ì„œë²„ë¦¬ìŠ¤
- ì‚¬ìš©í•œ ë§Œí¼ë§Œ ê³¼ê¸ˆ
- ìë™ ìŠ¤ì¼€ì¼ë§
- ê´€ë¦¬ ë¶€ë‹´ ìµœì†Œí™”

### âœ… ë¬´ë£Œ í‹°ì–´
- Lambda: ì›” 100ë§Œ ìš”ì²­ ë¬´ë£Œ
- API Gateway: ì›” 100ë§Œ API í˜¸ì¶œ ë¬´ë£Œ
- DynamoDB: 25GB ì €ì¥ ë¬´ë£Œ

---

## ğŸ”§ ê´€ë¦¬ ë° ëª¨ë‹ˆí„°ë§

### CloudWatch ë¡œê·¸ í™•ì¸
```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
aws logs tail /aws/lambda/mcp-poc-mcp-server --follow

# ìµœê·¼ 10ë¶„ ë¡œê·¸
aws logs tail /aws/lambda/mcp-poc-mcp-server --since 10m
```

### Lambda í•¨ìˆ˜ ì—…ë°ì´íŠ¸
```bash
cd cdk
cdk deploy
```

### í™˜ê²½ ë³€ìˆ˜ ìˆ˜ì •
`cdk/lib/mcp-login-poc-stack.ts` íŒŒì¼ì—ì„œ Lambda í™˜ê²½ ë³€ìˆ˜ ìˆ˜ì • í›„ ì¬ë°°í¬

---

## ğŸ› ë¬¸ì œ í•´ê²°

### "Unable to connect to MCP server"
**ì›ì¸:** URLì´ ì˜ëª»ë˜ì—ˆê±°ë‚˜ Lambda í•¨ìˆ˜ ì˜¤ë¥˜

**í•´ê²°:**
1. URL í™•ì¸: https://3b044wjwkf.execute-api.ap-northeast-2.amazonaws.com
2. í—¬ìŠ¤ì²´í¬ í™•ì¸: `curl https://.../health`
3. CloudWatch ë¡œê·¸ í™•ì¸

### "Internal Server Error"
**ì›ì¸:** Lambda í•¨ìˆ˜ ë‚´ë¶€ ì˜¤ë¥˜

**í•´ê²°:**
```bash
aws logs tail /aws/lambda/mcp-poc-mcp-server --since 5m
```
ë¡œê·¸ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

### Claudeì—ì„œ íˆ´ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ
**ì›ì¸:** ì»¤ë„¥í„°ê°€ í™œì„±í™”ë˜ì§€ ì•ŠìŒ

**í•´ê²°:**
1. ì±„íŒ… ì¢Œì¸¡ í•˜ë‹¨ "Search and tools" í´ë¦­
2. "Luna Card MCP Server" í† ê¸€ í™•ì¸
3. OFFë¼ë©´ ONìœ¼ë¡œ ë³€ê²½

---

## ğŸ“ˆ ë‹¤ìŒ ë‹¨ê³„

### í”„ë¡œë•ì…˜ ì¤€ë¹„
1. **OAuth ì™„ì „ êµ¬í˜„** - Lambdaì—ì„œ OAuth íë¦„ ì§€ì›
2. **Rate Limiting** - API Gatewayì— ìš”ì²­ ì œí•œ ì¶”ê°€
3. **ëª¨ë‹ˆí„°ë§** - CloudWatch ì•ŒëŒ ì„¤ì •
4. **ë³´ì•ˆ** - API Key ë˜ëŠ” JWT ì¸ì¦ ê°•í™”

### ê¸°ëŠ¥ í™•ì¥
1. **ìƒˆë¡œìš´ íˆ´ ì¶”ê°€** - Lambda ì½”ë“œì— íˆ´ ì¶”ê°€
2. **ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ í†µí•©** - S3, RDS ë“±
3. **ì»¤ìŠ¤í…€ ë„ë©”ì¸** - Route 53ìœ¼ë¡œ ì˜ˆìœ URL ì„¤ì •

---

## ğŸ‰ ì™„ë£Œ!

ì´ì œ Claudeì—ì„œ ë£¨ë‚˜ì¹´ë“œ APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

**í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€:**
```
"ë£¨ë‚˜ì¹´ë“œ ìƒí’ˆ ëª©ë¡ì„ ì•Œë ¤ì¤˜"
"ë£¨ë‚˜ì¹´ë“œì— ëŒ€í•´ ì„¤ëª…í•´ì¤˜"
"ê¸ˆìœµ ìƒí’ˆ ì¤‘ ì¶”ì²œí•´ì¤˜"
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Claude Custom Connectors ê°€ì´ë“œ](https://support.claude.com/en/articles/11175166-getting-started-with-custom-connectors-using-remote-mcp)
- [Model Context Protocol](https://modelcontextprotocol.io)
- [AWS Lambda ë¬¸ì„œ](https://docs.aws.amazon.com/lambda/)
- [API Gateway ë¬¸ì„œ](https://docs.aws.amazon.com/apigateway/)

